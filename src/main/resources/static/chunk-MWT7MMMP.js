import{a as P}from"./chunk-WIUCI3C3.js";import{a as Z}from"./chunk-C2NNGSFC.js";import{a as J,b as y,c as m,d as C,e as S,h as W,i as V,j as w,k as x,l as _,m as A,n as N,o as Y,p as D,r as I,s as B}from"./chunk-4DRA6TXY.js";import{d as z,f as F,g as $,j as Q,k as E}from"./chunk-4XY7KMRM.js";import{$a as H,Ba as p,Ga as v,Ha as h,Ma as b,Oa as U,Va as f,W as T,Wa as i,X as O,Xa as e,Ya as l,cb as u,db as R,fb as r,gb as g,hb as G,mb as K,na as s,ob as L,qb as j,u as k,xa as c}from"./chunk-M4Y7OEIM.js";function le(a,o){if(a&1){let t=H();i(0,"tr",23)(1,"td")(2,"input",24),u("change",function(){T(t);let n=R();return O(n.atualizarTotal())}),e()(),i(3,"td"),r(4),e(),i(5,"td"),r(6),e(),i(7,"td"),r(8),L(9,"number"),e(),i(10,"td")(11,"input",25),u("input",function(){T(t);let n=R();return O(n.atualizarTotal())}),e()()()}if(a&2){let t=o.$implicit;f("formGroup",t),s(4),g(t.value.detalhe),s(2),g(t.value.marca),s(2),G("R$ ",j(9,5,t.value.precoVenda,"1.2-2")),s(3),f("disabled",!t.value.selecionado)}}var M=class a{constructor(o,t,d,n){this.produtoService=o;this.vendaService=t;this.notificacaoService=d;this.fb=n}produtos=[];produtosFiltrados=[];vendas=[];total=0;loading=!1;formVenda;ngOnInit(){this.formVenda=this.fb.group({formaPagamento:["dinheiro",m.required],produtos:this.fb.array([])}),this.carregarProdutos()}get produtosFormArray(){return this.formVenda.get("produtos")}carregarProdutos(){this.loading=!0,this.produtoService.listarTodos().subscribe({next:o=>{this.produtos=o,this.produtosFiltrados=[...o],this.produtosFormArray.clear(),o.forEach(t=>{this.produtosFormArray.push(this.fb.group({id:[t.id],detalhe:[t.detalhe],marca:[t.marca],categoria:[t.categoria],precoCompra:[t.precoCompra],precoVenda:[t.precoVenda],quantidadeEstoque:[t.quantidadeEstoque],selecionado:[!1],quantidadeVenda:[1,[m.required,m.min(1)]]}))}),this.loading=!1},error:()=>{this.loading=!1}})}filtrar(o){let t=o.target.value.toLowerCase();this.produtosFiltrados=this.produtos.filter(d=>d.detalhe.toLowerCase().includes(t)||d.marca.toLowerCase().includes(t))}atualizarTotal(){this.total=this.produtosFormArray.controls.filter(o=>o.value.selecionado).reduce((o,t)=>o+t.value.precoVenda*t.value.quantidadeVenda,0)}finalizarVenda(){let o=this.produtosFormArray.controls.filter(n=>n.value.selecionado).map(n=>n.value);if(o.length===0){this.notificacaoService.emitirAviso("Selecione ao menos um produto.");return}let t=o.find(n=>n.quantidadeEstoque===0);if(t){this.notificacaoService.emitirErro(`O produto "${t.detalhe}" est\xE1 sem estoque!`);return}this.loading=!0;let d=o.map(n=>{let X={dataVenda:new Date().toISOString().split("T")[0],categoria:n.categoria,produto:n.detalhe,marca:n.marca,precoCompra:n.precoCompra,precoVenda:n.precoVenda,formaPagamento:this.formVenda.value.formaPagamento,quantidadeVendida:n.quantidadeVenda};return this.vendaService.criarVenda(X)});k(d).subscribe({next:()=>{this.notificacaoService.emitirSucesso("Venda registrada com sucesso!"),this.carregarProdutos(),this.carregarVendas(),this.atualizarTotal(),this.produtosFormArray.controls.forEach(n=>n.patchValue({selecionado:!1,quantidadeVenda:1}))},error:()=>{this.notificacaoService.emitirErro("Venda n\xE3o foi realizada!")},complete:()=>this.loading=!1})}carregarVendas(){this.vendaService.listarVendas().subscribe({next:o=>this.vendas=o,error:o=>console.error(o)})}static \u0275fac=function(t){return new(t||a)(c(P),c(Z),c(B),c(D))};static \u0275cmp=p({type:a,selectors:[["app-modal-vender"]],decls:46,vars:6,consts:[["id","modalVenda","tabindex","-1","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content","rounded-4","shadow-lg","border-0"],[1,"modal-header","bg-success","text-white","rounded-top-4"],[1,"modal-title","fw-bold"],[1,"bi","bi-cart-plus","me-2"],["type","button","data-bs-dismiss","modal",1,"btn-close","btn-close-white"],[1,"modal-body",3,"formGroup"],["type","text","placeholder","Pesquisar...",1,"form-control","mb-3",3,"input"],[1,"table","table-sm","text-center"],[1,"table-light"],[3,"formGroup",4,"ngFor","ngForOf"],["formControlName","formaPagamento",1,"form-select","mb-3"],["value","dinheiro"],["value","pix"],["value","debito"],["value","credito"],[1,"alert","alert-info","d-flex","justify-content-between"],[1,"fw-bold","fs-5"],[1,"modal-footer"],["data-bs-dismiss","modal",1,"btn","btn-secondary"],["data-bs-toggle","modal","data-bs-target","#modalVenda",1,"btn","btn-success",3,"click"],[1,"bi","bi-check-circle","me-1"],[3,"formGroup"],["type","checkbox","formControlName","selecionado",3,"change"],["type","number","formControlName","quantidadeVenda","min","1",1,"form-control","form-control-sm","w-50","mx-auto",3,"input","disabled"]],template:function(t,d){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),l(5,"i",5),r(6,"Registrar Venda "),e(),l(7,"button",6),e(),i(8,"div",7)(9,"input",8),u("input",function(X){return d.filtrar(X)}),e(),i(10,"table",9)(11,"thead",10)(12,"tr")(13,"th"),r(14,"Selecionar"),e(),i(15,"th"),r(16,"Produto"),e(),i(17,"th"),r(18,"Marca"),e(),i(19,"th"),r(20,"Pre\xE7o Unit."),e(),i(21,"th"),r(22,"Quantidade"),e()()(),i(23,"tbody"),v(24,le,12,8,"tr",11),e()(),i(25,"select",12)(26,"option",13),r(27,"Dinheiro"),e(),i(28,"option",14),r(29,"Pix"),e(),i(30,"option",15),r(31,"Cart\xE3o de D\xE9bito"),e(),i(32,"option",16),r(33,"Cart\xE3o de Cr\xE9dito"),e()(),i(34,"div",17)(35,"span"),r(36,"Total:"),e(),i(37,"span",18),r(38),L(39,"number"),e()()(),i(40,"div",19)(41,"button",20),r(42,"Cancelar"),e(),i(43,"button",21),u("click",function(){return d.finalizarVenda()}),l(44,"i",22),r(45,"Finalizar Venda "),e()()()()()),t&2&&(s(8),f("formGroup",d.formVenda),s(16),f("ngForOf",d.produtosFormArray.controls),s(14),G("R$ ",j(39,3,d.total,"1.2-2")))},dependencies:[E,F,I,A,N,y,V,J,_,C,S,Y,w,x,Q],encapsulation:2})};var de=()=>["Carnes","Temperos","Bebidas","Frios","Doces"];function me(a,o){if(a&1&&(i(0,"option",33),r(1),e()),a&2){let t=o.$implicit;f("value",t),s(),g(t)}}function se(a,o){a&1&&(i(0,"div",34),l(1,"div",35),e())}var q=class a{constructor(o,t,d){this.fb=o;this.produtoService=t;this.notificacaoService=d;this.produtoForm=this.fb.group({categoria:["",m.required],detalhe:["",m.required],marca:["",m.required],precoCompra:[null,[m.required,m.min(.01)]],precoVenda:[null,[m.required,m.min(.01)]],quantidadeEstoque:[null,[m.required,m.min(1)]],vencimento:["",m.required]})}loading=!1;produtoForm;alertaMensagem=null;tipoAlerta="success";ngOnInit(){this.notificacaoService.notificacao$.subscribe(o=>{this.alertaMensagem=o.mensagem,this.tipoAlerta=o.tipo})}adicionarProduto(){if(this.produtoForm.invalid){this.notificacaoService.emitirAviso("Preencha todos os campos corretamente!");return}let o=this.produtoForm.value;this.loading=!0,this.produtoService.salvar(o).subscribe({next:()=>{this.produtoForm.reset(),this.notificacaoService.emitirSucesso("Produto salvo com sucesso!")},error:()=>{this.notificacaoService.emitirErro("Erro ao salvar o produto.")},complete:()=>{this.loading=!1}})}static \u0275fac=function(t){return new(t||a)(c(D),c(P),c(B))};static \u0275cmp=p({type:a,selectors:[["app-modal-inserir"]],decls:49,vars:4,consts:[["id","modalAdicionarProduto","tabindex","-1","aria-labelledby","modalAdicionarProdutoLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","rounded-4","shadow-lg","border-0"],[1,"modal-header","bg-primary","text-white","rounded-top-4"],["id","modalAdicionarProdutoLabel",1,"modal-title","fw-bold"],[1,"bi","bi-plus-circle","me-2"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close","btn-close-white"],[1,"modal-body"],[3,"formGroup"],[1,"mb-3"],["for","categoriaProduto",1,"form-label","fw-semibold"],["id","categoriaProduto","formControlName","categoria",1,"form-select"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","detalheProduto",1,"form-label","fw-semibold"],["type","text","id","detalheProduto","placeholder","Ex: Requeij\xE3o Cremoso 500g","formControlName","detalhe",1,"form-control"],["for","marcaProduto",1,"form-label","fw-semibold"],["type","text","id","marcaProduto","placeholder","Ex: Itamb\xE9","formControlName","marca",1,"form-control"],[1,"row"],[1,"col-md-6","mb-3"],["for","precoCompra",1,"form-label","fw-semibold"],["type","number","step","0.01","id","precoCompra","placeholder","Ex: 5.50","formControlName","precoCompra",1,"form-control"],["for","precoVend",1,"form-label","fw-semibold"],["type","number","step","0.01","id","precoVend","placeholder","Ex: 9.90","formControlName","precoVenda",1,"form-control"],["for","qtdEstoque",1,"form-label","fw-semibold"],["type","number","id","qtdEstoque","placeholder","Ex: 20","formControlName","quantidadeEstoque",1,"form-control"],["for","dataVencimento",1,"form-label","fw-semibold"],["type","date","id","dataVencimento","formControlName","vencimento",1,"form-control"],["class","text-center py-4",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-bs-toggle","modal","data-bs-target","#modalAdicionarProduto",1,"btn","btn-primary",3,"click"],[1,"bi","bi-save","me-1"],[3,"value"],[1,"text-center","py-4"],[1,"spinner-border","text-primary"]],template:function(t,d){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),l(5,"i",5),r(6,"Adicionar Produto ao Estoque "),e(),l(7,"button",6),e(),i(8,"div",7)(9,"form",8)(10,"div",9)(11,"label",10),r(12,"Categoria"),e(),i(13,"select",11)(14,"option",12),r(15,"Selecione a categoria"),e(),v(16,me,2,2,"option",13),e()(),i(17,"div",9)(18,"label",14),r(19,"Detalhe"),e(),l(20,"input",15),e(),i(21,"div",9)(22,"label",16),r(23,"Marca"),e(),l(24,"input",17),e(),i(25,"div",18)(26,"div",19)(27,"label",20),r(28,"Pre\xE7o de Compra"),e(),l(29,"input",21),e(),i(30,"div",19)(31,"label",22),r(32,"Pre\xE7o de Venda"),e(),l(33,"input",23),e()(),i(34,"div",9)(35,"label",24),r(36,"Qtd. em Estoque"),e(),l(37,"input",25),e(),i(38,"div",9)(39,"label",26),r(40,"Data de Vencimento"),e(),l(41,"input",27),e(),v(42,se,2,0,"div",28),e()(),i(43,"div",29)(44,"button",30),r(45,"Cancelar"),e(),i(46,"button",31),u("click",function(){return d.adicionarProduto()}),l(47,"i",32),r(48,"Salvar Produto "),e()()()()()),t&2&&(s(9),f("formGroup",d.produtoForm),s(7),f("ngForOf",K(3,de)),s(26),f("ngIf",d.loading))},dependencies:[E,F,$,I,W,A,N,y,V,_,C,S,w,x],encapsulation:2})};var ce=()=>[import("./chunk-CHBUJRKL.js").then(a=>a.Estoque)],fe=()=>[import("./chunk-4MBCPCVR.js").then(a=>a.Vendas)],ue=()=>[import("./chunk-ZEKHWQ2A.js").then(a=>a.Footer)];function pe(a,o){a&1&&l(0,"app-estoque")}function ve(a,o){a&1&&l(0,"app-vendas")}function ge(a,o){a&1&&l(0,"app-footer")}var ie=class a{constructor(o){this.location=o;this.location.go("/home")}static \u0275fac=function(t){return new(t||a)(c(z))};static \u0275cmp=p({type:a,selectors:[["app-home"]],decls:13,vars:0,consts:[[1,"container","py-4"],[1,"card","shadow-lg","rounded-4","p-4"]],template:function(t,d){t&1&&(i(0,"div",0)(1,"div",1),h(2,pe,1,0),b(3,2,ce),U(),e(),l(5,"app-modal-inserir")(6,"app-modal-vender"),h(7,ve,1,0),b(8,7,fe),U(),h(10,ge,1,0),b(11,10,ue),U(),e())},dependencies:[M,q],styles:['@font-face{font-family:Nunito;font-style:italic;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXX3I6Li01BKofIMNaORs71cA.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Nunito;font-style:italic;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXX3I6Li01BKofIMNaHRs71cA.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Nunito;font-style:italic;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXX3I6Li01BKofIMNaMRs71cA.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Nunito;font-style:italic;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXX3I6Li01BKofIMNaNRs71cA.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Nunito;font-style:italic;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXX3I6Li01BKofIMNaDRs4.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Nunito;font-style:normal;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXV3I6Li01BKofIOOaBXso.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Nunito;font-style:normal;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXV3I6Li01BKofIMeaBXso.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Nunito;font-style:normal;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXV3I6Li01BKofIOuaBXso.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Nunito;font-style:normal;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXV3I6Li01BKofIO-aBXso.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Nunito;font-style:normal;font-weight:200 1000;font-display:swap;src:url(https://fonts.gstatic.com/s/nunito/v32/XRXV3I6Li01BKofINeaB.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}body[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{font-family:Nunito,sans-serif;font-optical-sizing:auto;font-weight:weight;font-style:normal;letter-spacing:1px}.search-input[_ngcontent-%COMP%]{border-radius:50px!important;padding-left:18px}']})};export{ie as Home};
